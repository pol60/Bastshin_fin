{"version":3,"file":"ProductDetail-DAE-fbPB.js","sources":["../../src/pages/ProductDetail.tsx"],"sourcesContent":["import { memo, FC, useState, useEffect, useCallback } from 'react';\nimport { useParams, useNavigate, Link, useLocation } from 'react-router-dom';\nimport { Star } from 'lucide-react';\nimport CustomCarIcon from '../components/icons/CustomCarIcon';\nimport SnowflakeIcon from '../components/icons/SnowflakeIcon';\nimport SunIcon from '../components/icons/SunIcon';\nimport SnowSunIcon from '../components/icons/SnowSunIcon';\nimport ReactCountryFlag from 'react-country-flag';\nimport { Product } from '../types/database.types';\nimport { useCartStore } from '../stores/cartStore';\nimport { supabase } from '../lib/supabaseClient';\nimport { useTouchHandlers, useIsMobile } from '../hooks/useIsMobile';\nimport { User } from '@supabase/supabase-js';\n\ninterface Review {\n  id: string;\n  product_id: string;\n  comment: string;\n  created_at: string;\n  user_id: string;\n  rating: number;\n}\n\n// Компонент для загрузки изображения с эффектом fadeIn\nconst FadeInImage: FC<{ src: string; alt: string }> = ({ src, alt }) => {\n  const [isLoaded, setIsLoaded] = useState(false);\n\n  return (\n    <img\n      src={src}\n      alt={alt}\n      onLoad={() => setIsLoaded(true)}\n      className={`w-full h-full object-contain ${isLoaded ? 'fadeIn' : 'opacity-0'}`}\n      loading=\"eager\"\n      decoding=\"async\"\n    />\n  );\n};\n\nconst ThumbnailButton = memo(({ img, active, onClick }: { img: string; active: boolean; onClick: () => void; }) => (\n  <button\n    onClick={onClick}\n    className={`border rounded-lg overflow-hidden transition-all duration-300 ${active ? 'ring-2 ring-blue-500' : ''}`}\n  >\n    <img\n      src={img}\n      alt=\"Превью товара\"\n      className=\"w-full h-8 object-contain\"\n      loading=\"lazy\"\n      width={40}\n      height={40}\n    />\n  </button>\n));\n\nconst DotsIndicator: FC<{ count: number; activeIndex: number; onChange: (index: number) => void; }> = ({ count, activeIndex, onChange }) => (\n  <div className=\"flex justify-center gap-2 mt-4\">\n    {Array.from({ length: count }).map((_, index) => (\n      <button\n        key={index}\n        onClick={() => onChange(index)}\n        className={`w-2 h-2 rounded-full transition-all duration-300 ${index === activeIndex ? 'bg-blue-500 scale-125' : 'bg-gray-300 hover:bg-gray-400'}`}\n      />\n    ))}\n  </div>\n);\n\nconst RatingStars: FC<{ rating: number; starSizeClass?: string; }> = ({ rating, starSizeClass = 'w-5 h-5' }) => (\n  <div className=\"flex items-center\">\n    {Array.from({ length: 5 }, (_, i) => (\n      <Star key={i} className={`${starSizeClass} ${i < Math.floor(rating) ? 'text-yellow-400 fill-current' : 'text-gray-300'}`} />\n    ))}\n  </div>\n);\n\nconst hasValueForDisplay = (val: string | number | undefined): boolean => {\n  if (val === undefined || val === null) return false;\n  if (typeof val === 'string') return val.trim() !== '';\n  return true;\n};\n\nconst hasStringValue = (val: string | undefined): val is string => {\n  return typeof val === 'string' && val.trim() !== '';\n};\n\nconst getVehicleType = (type: string | undefined) => {\n  if (!hasStringValue(type)) return '';\n  return type.toLowerCase() === 'tire' ? 'Легковий' : type;\n};\n\nexport const ProductDetail: FC = () => {\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [product, setProduct] = useState<Product | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [quantity, setQuantity] = useState(1);\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\n\n  const addItem = useCartStore((state) => state.addItem);\n\n  // Состояния для отзывов\n  const [reviews, setReviews] = useState<Review[]>([]);\n  const [newComment, setNewComment] = useState('');\n  const [rating, setRating] = useState(5);\n  const [user, setUser] = useState<User | null>(null);\n\n  // Запрос товара из Supabase\n  const fetchProduct = useCallback(async () => {\n    if (!id) return;\n    try {\n      const { data, error } = await supabase\n        .from('products')\n        .select('*, reviews:reviews!product_id (id, rating)')\n        .eq('id', id)\n        .single();\n\n      if (error) throw error;\n      if (data) {\n        const productData = {\n          ...data,\n          reviews_count: data.reviews?.length || 0,\n          rating: data.rating,\n        } as Product;\n        setProduct(productData);\n      }\n    } catch (error) {\n      console.error('Error fetching product:', error);\n      setProduct(null);\n    } finally {\n      setLoading(false);\n    }\n  }, [id]);\n\n  useEffect(() => {\n    fetchProduct();\n  }, [fetchProduct]);\n\n  // Загрузка отзывов для товара\n  useEffect(() => {\n    const loadReviews = async () => {\n      const { data, error } = await supabase\n        .from('reviews')\n        .select('id, product_id, comment, created_at, user_id, rating')\n        .eq('product_id', id)\n        .order('created_at', { ascending: false });\n\n      if (!error && data) setReviews(data as Review[]);\n    };\n\n    if (id) loadReviews();\n  }, [id]);\n\n  // Проверка авторизации пользователя\n  useEffect(() => {\n    const checkAuth = async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      setUser(user);\n    };\n    checkAuth();\n  }, []);\n\n  const handleQuantityChange = useCallback((value: number) => {\n    setQuantity((prev) => Math.max(1, prev + value));\n  }, []);\n\n  const handleDotClick = useCallback((index: number) => {\n    setCurrentImageIndex(index);\n  }, []);\n\n  // Обработка отправки нового отзыва\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!user) {\n      navigate('/auth', { state: { from: location.pathname } });\n      return;\n    }\n\n    if (!newComment.trim()) return;\n\n    const { data, error } = await supabase\n      .from('reviews')\n      .insert([{ product_id: id, comment: newComment, rating, user_id: user.id }])\n      .select();\n\n    if (!error && data) {\n      setReviews([data[0] as Review, ...reviews]);\n      setNewComment('');\n      setRating(5);\n    }\n  };\n\n  // Хуки для мобильных устройств и обработки свайпов\n  const isMobile = useIsMobile();\n  const { handleTouchStart, handleTouchMove, handleTouchEnd, handleTouchCancel } = useTouchHandlers({\n    onSwipe: (direction) => {\n      if (!product) return;\n      if (direction === 'left' && currentImageIndex < product.image_url.length - 1) {\n        setCurrentImageIndex(currentImageIndex + 1);\n      } else if (direction === 'right' && currentImageIndex > 0) {\n        setCurrentImageIndex(currentImageIndex - 1);\n      }\n    },\n  });\n\n  if (loading) return null;\n  if (!product) {\n    return (\n      <div className=\"bg-white min-h-screen flex flex-col justify-center items-center px-4 py-8\">\n        <h1 className=\"text-2xl font-bold text-gray-800 mb-4\">Товар не знайдено</h1>\n        <button onClick={() => navigate('/')} className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors\">\n          На головну\n        </button>\n      </div>\n    );\n  }\n\n  const countryCode = hasStringValue(product.country) && product.country.length === 2 ? product.country.toUpperCase() : 'US';\n\n  const titleLine = [\n    hasStringValue(product.brand) ? product.brand : '',\n    hasStringValue(product.model) ? product.model : '',\n    (hasValueForDisplay(product.width) || hasValueForDisplay(product.profile) || hasValueForDisplay(product.diameter))\n      ? `${product.width ?? ''}/${product.profile ?? ''} R${product.diameter ?? ''}`\n      : '',\n    (hasValueForDisplay(product.load_index) || hasValueForDisplay(product.speed_index))\n      ? `${product.load_index ?? ''}${product.speed_index ?? ''}`\n      : '',\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  const characteristics = [\n    { label: 'Тип:', value: getVehicleType(product.type), condition: hasStringValue(product.type) },\n    { label: 'Бренд:', value: product.brand, condition: hasStringValue(product.brand) },\n    { label: 'Модель:', value: product.model, condition: hasStringValue(product.model) },\n    {\n      label: 'Розмір:',\n      value: (hasValueForDisplay(product.width) || hasValueForDisplay(product.profile) || hasValueForDisplay(product.diameter))\n        ? `${product.width ?? ''}/${product.profile ?? ''} R${product.diameter ?? ''}`\n        : '',\n      condition: hasValueForDisplay(product.width) || hasValueForDisplay(product.profile) || hasValueForDisplay(product.diameter),\n    },\n    {\n      label: 'Сезон:',\n      value:\n        product.season === 'winter'\n          ? 'Зимові'\n          : product.season === 'summer'\n          ? 'Літні'\n          : product.season === 'all-season'\n          ? 'Всесезонні'\n          : '',\n      condition: hasStringValue(product.season),\n    },\n    { label: 'Рік випуску:', value: product.year, condition: hasValueForDisplay(product.year) },\n    {\n      label: 'Індекс Навантаження:',\n      value: hasValueForDisplay(product.load_index)\n        ? typeof product.load_index === 'string'\n          ? product.load_index.toUpperCase()\n          : String(product.load_index)\n        : '',\n      condition: hasValueForDisplay(product.load_index),\n    },\n    {\n      label: 'Індекс Швидкості:',\n      value: hasValueForDisplay(product.speed_index)\n        ? typeof product.speed_index === 'string'\n          ? product.speed_index.toUpperCase()\n          : String(product.speed_index)\n        : '',\n      condition: hasValueForDisplay(product.speed_index),\n    },\n    {\n      label: 'Шипи:',\n      value: product.spikes !== undefined ? (product.spikes ? 'ТАК' : 'НІ') : '',\n      condition: product.spikes !== undefined,\n    },\n    {\n      label: 'Зчеплення:',\n      value: hasStringValue(product.wet_grip)\n        ? typeof product.wet_grip === 'string'\n          ? product.wet_grip.toUpperCase()\n          : String(product.wet_grip)\n        : '',\n      condition: hasStringValue(product.wet_grip),\n    },\n    {\n      label: 'Паливо:',\n      value: hasStringValue(product.fuel_efficiency)\n        ? typeof product.fuel_efficiency === 'string'\n          ? product.fuel_efficiency.toUpperCase()\n          : String(product.fuel_efficiency)\n        : '',\n      condition: hasStringValue(product.fuel_efficiency),\n    },\n    {\n      label: 'Рівень шуму dB:',\n      value: product.noise_level,\n      condition: product.noise_level !== undefined,\n    },\n  ];\n\n  return (\n    <div className=\"bg-white min-h-screen relative\">\n      <div className=\"mx-auto px-4 py-8\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n          {/* Левая колонка: Слайдер изображений */}\n          <div className=\"relative\">\n            {product.image_url && product.image_url.length > 1 ? (\n              <div\n                className=\"w-full  h-[320px] bg-white rounded-lg overflow-hidden\"\n                {...(isMobile\n                  ? {\n                      onTouchStart: handleTouchStart,\n                      onTouchMove: handleTouchMove,\n                      onTouchEnd: handleTouchEnd,\n                      onTouchCancel: handleTouchCancel,\n                    }\n                  : {})}\n              >\n                <div\n                  className=\"flex h-full transition-transform duration-300 ease-in-out\"\n                  style={{ transform: `translateX(-${currentImageIndex * 100}%)` }}\n                >\n                  {product.image_url.map((img) => (\n                    <div key={img} className=\"w-full h-[300px] flex-shrink-0\">\n                      <FadeInImage src={img} alt={titleLine} />\n                    </div>\n                  ))}\n                </div>\n              </div>\n            ) : (\n              <div className=\"w-full h-[300px] bg-white rounded-lg overflow-hidden\">\n                <FadeInImage src={product.image_url?.[0] || ''} alt={titleLine} />\n              </div>\n            )}\n            {product.image_url && product.image_url.length > 1 && (\n              <>\n                <DotsIndicator count={product.image_url.length} activeIndex={currentImageIndex} onChange={handleDotClick} />\n                <div className=\"mt-4 flex justify-center \">\n                  <div className=\"grid grid-cols-4 gap-2 w-60 \">\n                    {product.image_url.map((img, index) => (\n                      <ThumbnailButton key={img} img={img} active={currentImageIndex === index} onClick={() => setCurrentImageIndex(index)} />\n                    ))}\n                  </div>\n                </div>\n              </>\n            )}\n          </div>\n\n          {/* Правая колонка: Информация о товаре */}\n          <div className=\"md:origin-top-left inline-block md:text-[0.8rem]\">\n            <h1 className=\"text-xl font-bold mb-4\">{titleLine}</h1>\n            <div className=\"flex items-center mb-4\">\n              <RatingStars rating={product.rating} />\n              <span className=\"text-sm text-gray-600 ml-2\">({product.reviews_count} відгуків)</span>\n              <span className=\"ml-4 text-sm text-gray-600\">Артикул: {product.id.slice(0, 8).toUpperCase()}</span>\n            </div>\n            <div className=\"flex items-center gap-6 mb-2 text-sm text-gray-600\">\n              <div className=\"flex items-center gap-2\">\n                <span>Сезон:</span>\n                {product.season === 'winter' ? (\n                  <SnowflakeIcon className=\"w-5 h-5 text-blue-600\" />\n                ) : product.season === 'summer' ? (\n                  <SunIcon className=\"w-5 h-5 text-yellow-500\" />\n                ) : product.season === 'all-season' ? (\n                  <SnowSunIcon className=\"w-5 h-5 text-green-600\" />\n                ) : null}\n                <span>\n                  {product.season === 'winter'\n                    ? 'Зимові'\n                    : product.season === 'summer'\n                    ? 'Літні'\n                    : product.season === 'all-season'\n                    ? 'Всесезонні'\n                    : ''}\n                </span>\n              </div>\n              {hasStringValue(product.type) && (\n                <div className=\"flex items-center gap-2 ml-10\">\n                  <span>Тип:</span>\n                  <span>{getVehicleType(product.type)}</span>\n                  <CustomCarIcon className=\"w-5 h-5 text-blue-600 -mt-1\" />\n                </div>\n              )}\n            </div>\n            <div className=\"mb-4\">\n              {product.sale_price ? (\n                <div className=\"flex items-center gap-4\">\n                  <span className=\"text-3xl font-bold text-red-500\">{product.sale_price} ₴</span>\n                  <span className=\"text-xl text-gray-400 line-through\">{product.price} ₴</span>\n                </div>\n              ) : (\n                <span className=\"text-3xl font-bold\">{product.price} ₴</span>\n              )}\n            </div>\n            <div className=\"mb-6 flex items-center gap-4\">\n              <div className=\"flex items-center border border-gray-300 rounded-md\">\n                <button onClick={() => handleQuantityChange(-1)} className=\"px-3 py-2 text-gray-600 hover:bg-gray-100\">-</button>\n                <input\n                  type=\"number\"\n                  min=\"1\"\n                  value={quantity}\n                  onChange={(e) => setQuantity(Math.max(1, Number(e.target.value) || 1))}\n                  className=\"w-16 text-center border-x border-gray-300 py-2\"\n                />\n                <button onClick={() => handleQuantityChange(1)} className=\"px-3 py-2 text-gray-600 hover:bg-gray-100\">+</button>\n              </div>\n              <button onClick={() => addItem(product.id, quantity)} className=\"flex-1 bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors\">\n                Купити\n              </button>\n            </div>\n            <div className=\"mb-6 text-sm text-gray-700 leading-relaxed\">\n              <h2 className=\"text-lg font-semibold mb-2\">Доставка</h2>\n              <p>Термін доставки 1-3 дні</p>\n              <p>Доставляємо службами Нова Пошта</p>\n              <p>Є можливість самовивозу зі складу в Одесі згідно графіку роботи</p>\n              <h2 className=\"text-lg font-semibold mt-4 mb-2\">Оплата</h2>\n              <p>Банківськими картами Visa/Mastercard</p>\n              <p>Готівкою при отриманні товару</p>\n              <p>Безготівковий розрахунок з ПДВ або без ПДВ</p>\n            </div>\n            <div className=\"mb-6\">\n              <h2 className=\"text-lg font-semibold mb-4\">Додаткові характеристики</h2>\n              <div className=\"space-y-3\">\n                {characteristics.map(\n                  (item, index) =>\n                    item.condition && (\n                      <div key={index} className=\"flex justify-between\">\n                        <span>{item.label}</span>\n                        <span>{item.value}</span>\n                      </div>\n                    )\n                )}\n                {hasStringValue(product.country) && (\n                  <div className=\"flex justify-between\">\n                    <span>Країна:</span>\n                    <span className=\"flex items-center gap-2\">\n                      <ReactCountryFlag\n                        countryCode={countryCode}\n                        svg\n                        className=\"w-5 h-5 rounded-full border\"\n                        title={product.country}\n                        aria-label={product.country}\n                      />\n                      <span>{product.country}</span>\n                    </span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Блок с отзывами */}\n        <div className=\"mt-4 md:mt-2\">\n          <h2 className=\"text-2xl font-bold mb-6\">Відгуки про товар</h2>\n          {user ? (\n            <form onSubmit={handleSubmit} className=\"mb-8 bg-gray-50 p-4 rounded-lg\">\n              <div className=\"mb-4\">\n                <label className=\"block mb-2 font-medium\">Ваша оцінка:</label>\n                <select\n                  value={rating}\n                  onChange={(e) => setRating(Number(e.target.value))}\n                  className=\"w-full p-2 border rounded\"\n                >\n                  {[5, 4, 3, 2, 1].map((num) => (\n                    <option key={num} value={num}>\n                      {num} ★\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <textarea\n                value={newComment}\n                onChange={(e) => setNewComment(e.target.value)}\n                className=\"w-full p-2 border rounded mb-4\"\n                placeholder=\"Напишіть ваш відгук...\"\n                rows={4}\n                required\n              />\n\n              <button type=\"submit\" className=\"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700\">\n                Опублікувати\n              </button>\n            </form>\n          ) : (\n            <div className=\"mb-8 flex justify-center\">\n              <button\n                onClick={() => navigate('/auth', { state: { from: location.pathname } })}\n                className=\"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition-colors\"\n              >\n                Написати відгук\n              </button>\n            </div>\n          )}\n\n          <div className=\"space-y-6\">\n            {reviews.slice(0, 3).map((review) => (\n              <div key={review.id} className=\"bg-white p-4 rounded-lg shadow-sm border\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <RatingStars rating={review.rating} starSizeClass=\"w-4 h-4\" />\n                  <span className=\"text-sm text-gray-500\">{new Date(review.created_at).toLocaleDateString('ru-RU')}</span>\n                </div>\n                <p className=\"text-gray-800 mb-2\">{review.comment}</p>\n                <div className=\"text-sm text-gray-500\">\n                  Користувач: анонімний {review.user_id.slice(0, 6)}\n                </div>\n              </div>\n            ))}\n          </div>\n          {product.reviews_count > 3 && (\n            <div className=\"mt-6 flex justify-center\">\n              <Link\n                to={`/product/${id}/comment`}\n                className=\"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-colors\"\n              >\n                Переглянути всі коментарі ({product.reviews_count})\n              </Link>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default memo(ProductDetail);\n"],"names":["FadeInImage","src","alt","isLoaded","setIsLoaded","useState","jsx","ThumbnailButton","memo","img","active","onClick","DotsIndicator","count","activeIndex","onChange","_","index","RatingStars","rating","starSizeClass","i","Star","hasValueForDisplay","val","hasStringValue","getVehicleType","type","ProductDetail","id","useParams","navigate","useNavigate","location","useLocation","product","setProduct","loading","setLoading","quantity","setQuantity","currentImageIndex","setCurrentImageIndex","addItem","useCartStore","state","reviews","setReviews","newComment","setNewComment","setRating","user","setUser","fetchProduct","useCallback","data","error","supabase","productData","_a","useEffect","handleQuantityChange","value","prev","handleDotClick","handleSubmit","e","isMobile","useIsMobile","handleTouchStart","handleTouchMove","handleTouchEnd","handleTouchCancel","useTouchHandlers","direction","jsxs","countryCode","titleLine","characteristics","Fragment","SnowflakeIcon","SunIcon","SnowSunIcon","CustomCarIcon","item","ReactCountryFlag","num","review","Link"],"mappings":"iTAwBA,MAAMA,EAAgD,CAAC,CAAE,IAAAC,EAAK,IAAAC,KAAU,CACtE,KAAM,CAACC,EAAUC,CAAW,EAAIC,EAAAA,SAAS,EAAK,EAG5C,OAAAC,EAAA,IAAC,MAAA,CACC,IAAAL,EACA,IAAAC,EACA,OAAQ,IAAME,EAAY,EAAI,EAC9B,UAAW,gCAAgCD,EAAW,SAAW,WAAW,GAC5E,QAAQ,QACR,SAAS,OAAA,CACX,CAEJ,EAEMI,GAAkBC,EAAK,KAAA,CAAC,CAAE,IAAAC,EAAK,OAAAC,EAAQ,QAAAC,KAC3CL,EAAA,IAAC,SAAA,CACC,QAAAK,EACA,UAAW,iEAAiED,EAAS,uBAAyB,EAAE,GAEhH,SAAAJ,EAAA,IAAC,MAAA,CACC,IAAKG,EACL,IAAI,gBACJ,UAAU,4BACV,QAAQ,OACR,MAAO,GACP,OAAQ,EAAA,CAAA,CACV,CACF,CACD,EAEKG,GAAgG,CAAC,CAAE,MAAAC,EAAO,YAAAC,EAAa,SAAAC,CAAS,UACnI,MAAI,CAAA,UAAU,iCACZ,SAAM,MAAA,KAAK,CAAE,OAAQF,CAAA,CAAO,EAAE,IAAI,CAACG,EAAGC,IACrCX,EAAA,IAAC,SAAA,CAEC,QAAS,IAAMS,EAASE,CAAK,EAC7B,UAAW,oDAAoDA,IAAUH,EAAc,wBAA0B,+BAA+B,EAAA,EAF3IG,CAGP,CACD,EACH,EAGIC,EAA+D,CAAC,CAAE,OAAAC,EAAQ,cAAAC,EAAgB,SAC9F,IAAAd,EAAA,IAAC,MAAI,CAAA,UAAU,oBACZ,SAAM,MAAA,KAAK,CAAE,OAAQ,CAAK,EAAA,CAACU,EAAGK,UAC5BC,GAAa,CAAA,UAAW,GAAGF,CAAa,IAAIC,EAAI,KAAK,MAAMF,CAAM,EAAI,+BAAiC,eAAe,IAA3GE,CAA+G,CAC3H,EACH,EAGIE,EAAsBC,GACDA,GAAQ,KAAa,GAC1C,OAAOA,GAAQ,SAAiBA,EAAI,KAAW,IAAA,GAC5C,GAGHC,EAAkBD,GACf,OAAOA,GAAQ,UAAYA,EAAI,KAAW,IAAA,GAG7CE,EAAkBC,GACjBF,EAAeE,CAAI,EACjBA,EAAK,YAAA,IAAkB,OAAS,WAAaA,EADlB,GAIvBC,GAAoB,IAAM,OAC/B,KAAA,CAAE,GAAAC,CAAG,EAAIC,EAA0B,EACnCC,EAAWC,EAAY,EACvBC,EAAWC,EAAY,EACvB,CAACC,EAASC,CAAU,EAAI/B,EAAAA,SAAyB,IAAI,EACrD,CAACgC,EAASC,CAAU,EAAIjC,EAAAA,SAAS,EAAI,EACrC,CAACkC,EAAUC,CAAW,EAAInC,EAAAA,SAAS,CAAC,EACpC,CAACoC,EAAmBC,CAAoB,EAAIrC,EAAAA,SAAS,CAAC,EAEtDsC,EAAUC,GAAcC,GAAUA,EAAM,OAAO,EAG/C,CAACC,EAASC,CAAU,EAAI1C,EAAAA,SAAmB,CAAA,CAAE,EAC7C,CAAC2C,EAAYC,CAAa,EAAI5C,EAAAA,SAAS,EAAE,EACzC,CAACc,EAAQ+B,CAAS,EAAI7C,EAAAA,SAAS,CAAC,EAChC,CAAC8C,EAAMC,CAAO,EAAI/C,EAAAA,SAAsB,IAAI,EAG5CgD,EAAeC,EAAAA,YAAY,SAAY,OAC3C,GAAKzB,EACD,GAAA,CACF,KAAM,CAAE,KAAA0B,EAAM,MAAAC,CAAA,EAAU,MAAMC,EAC3B,KAAK,UAAU,EACf,OAAO,4CAA4C,EACnD,GAAG,KAAM5B,CAAE,EACX,OAAO,EAEV,GAAI2B,EAAa,MAAAA,EACjB,GAAID,EAAM,CACR,MAAMG,EAAc,CAClB,GAAGH,EACH,gBAAeI,EAAAJ,EAAK,UAAL,YAAAI,EAAc,SAAU,EACvC,OAAQJ,EAAK,MACf,EACAnB,EAAWsB,CAAW,CAAA,QAEjBF,EAAO,CACN,QAAA,MAAM,0BAA2BA,CAAK,EAC9CpB,EAAW,IAAI,CAAA,QACf,CACAE,EAAW,EAAK,CAAA,CAClB,EACC,CAACT,CAAE,CAAC,EAEP+B,EAAAA,UAAU,IAAM,CACDP,EAAA,CAAA,EACZ,CAACA,CAAY,CAAC,EAGjBO,EAAAA,UAAU,IAAM,CAWV/B,IAVgB,SAAY,CACxB,KAAA,CAAE,KAAA0B,EAAM,MAAAC,GAAU,MAAMC,EAC3B,KAAK,SAAS,EACd,OAAO,sDAAsD,EAC7D,GAAG,aAAc5B,CAAE,EACnB,MAAM,aAAc,CAAE,UAAW,GAAO,EAEvC,CAAC2B,GAASD,GAAMR,EAAWQ,CAAgB,CACjD,GAEoB,CAAA,EACnB,CAAC1B,CAAE,CAAC,EAGP+B,EAAAA,UAAU,IAAM,EACI,SAAY,CACtB,KAAA,CAAE,KAAM,CAAE,KAAAT,IAAW,MAAMM,EAAS,KAAK,QAAQ,EACvDL,EAAQD,CAAI,CACd,GACU,CACZ,EAAG,EAAE,EAEC,MAAAU,EAAuBP,cAAaQ,GAAkB,CAC1DtB,EAAauB,GAAS,KAAK,IAAI,EAAGA,EAAOD,CAAK,CAAC,CACjD,EAAG,EAAE,EAECE,EAAiBV,cAAarC,GAAkB,CACpDyB,EAAqBzB,CAAK,CAC5B,EAAG,EAAE,EAGCgD,EAAe,MAAOC,GAAuB,CAGjD,GAFAA,EAAE,eAAe,EAEb,CAACf,EAAM,CACApB,EAAA,QAAS,CAAE,MAAO,CAAE,KAAME,EAAS,QAAA,EAAY,EACxD,MAAA,CAGE,GAAA,CAACe,EAAW,OAAQ,OAElB,KAAA,CAAE,KAAAO,EAAM,MAAAC,GAAU,MAAMC,EAC3B,KAAK,SAAS,EACd,OAAO,CAAC,CAAE,WAAY5B,EAAI,QAASmB,EAAY,OAAA7B,EAAQ,QAASgC,EAAK,EAAG,CAAC,CAAC,EAC1E,OAAO,EAEN,CAACK,GAASD,IACZR,EAAW,CAACQ,EAAK,CAAC,EAAa,GAAGT,CAAO,CAAC,EAC1CG,EAAc,EAAE,EAChBC,EAAU,CAAC,EAEf,EAGMiB,EAAWC,GAAY,EACvB,CAAE,iBAAAC,EAAkB,gBAAAC,EAAiB,eAAAC,EAAgB,kBAAAC,CAAA,EAAsBC,GAAiB,CAChG,QAAUC,GAAc,CACjBvC,IACDuC,IAAc,QAAUjC,EAAoBN,EAAQ,UAAU,OAAS,EACzEO,EAAqBD,EAAoB,CAAC,EACjCiC,IAAc,SAAWjC,EAAoB,GACtDC,EAAqBD,EAAoB,CAAC,EAC5C,CACF,CACD,EAED,GAAIJ,EAAgB,OAAA,KACpB,GAAI,CAACF,EAED,OAAAwC,EAAA,KAAC,MAAI,CAAA,UAAU,4EACb,SAAA,CAACrE,EAAA,IAAA,KAAA,CAAG,UAAU,wCAAwC,SAAiB,oBAAA,EACvEA,EAAAA,IAAC,UAAO,QAAS,IAAMyB,EAAS,GAAG,EAAG,UAAU,+EAA+E,SAE/H,YAAA,CAAA,CAAA,EACF,EAIJ,MAAM6C,EAAcnD,EAAeU,EAAQ,OAAO,GAAKA,EAAQ,QAAQ,SAAW,EAAIA,EAAQ,QAAQ,YAAgB,EAAA,KAEhH0C,EAAY,CAChBpD,EAAeU,EAAQ,KAAK,EAAIA,EAAQ,MAAQ,GAChDV,EAAeU,EAAQ,KAAK,EAAIA,EAAQ,MAAQ,GAC/CZ,EAAmBY,EAAQ,KAAK,GAAKZ,EAAmBY,EAAQ,OAAO,GAAKZ,EAAmBY,EAAQ,QAAQ,EAC5G,GAAGA,EAAQ,OAAS,EAAE,IAAIA,EAAQ,SAAW,EAAE,KAAKA,EAAQ,UAAY,EAAE,GAC1E,GACHZ,EAAmBY,EAAQ,UAAU,GAAKZ,EAAmBY,EAAQ,WAAW,EAC7E,GAAGA,EAAQ,YAAc,EAAE,GAAGA,EAAQ,aAAe,EAAE,GACvD,EAEH,EAAA,OAAO,OAAO,EACd,KAAK,GAAG,EAEL2C,EAAkB,CACtB,CAAE,MAAO,OAAQ,MAAOpD,EAAeS,EAAQ,IAAI,EAAG,UAAWV,EAAeU,EAAQ,IAAI,CAAE,EAC9F,CAAE,MAAO,SAAU,MAAOA,EAAQ,MAAO,UAAWV,EAAeU,EAAQ,KAAK,CAAE,EAClF,CAAE,MAAO,UAAW,MAAOA,EAAQ,MAAO,UAAWV,EAAeU,EAAQ,KAAK,CAAE,EACnF,CACE,MAAO,UACP,MAAQZ,EAAmBY,EAAQ,KAAK,GAAKZ,EAAmBY,EAAQ,OAAO,GAAKZ,EAAmBY,EAAQ,QAAQ,EACnH,GAAGA,EAAQ,OAAS,EAAE,IAAIA,EAAQ,SAAW,EAAE,KAAKA,EAAQ,UAAY,EAAE,GAC1E,GACJ,UAAWZ,EAAmBY,EAAQ,KAAK,GAAKZ,EAAmBY,EAAQ,OAAO,GAAKZ,EAAmBY,EAAQ,QAAQ,CAC5H,EACA,CACE,MAAO,SACP,MACEA,EAAQ,SAAW,SACf,SACAA,EAAQ,SAAW,SACnB,QACAA,EAAQ,SAAW,aACnB,aACA,GACN,UAAWV,EAAeU,EAAQ,MAAM,CAC1C,EACA,CAAE,MAAO,eAAgB,MAAOA,EAAQ,KAAM,UAAWZ,EAAmBY,EAAQ,IAAI,CAAE,EAC1F,CACE,MAAO,uBACP,MAAOZ,EAAmBY,EAAQ,UAAU,EACxC,OAAOA,EAAQ,YAAe,SAC5BA,EAAQ,WAAW,YAAY,EAC/B,OAAOA,EAAQ,UAAU,EAC3B,GACJ,UAAWZ,EAAmBY,EAAQ,UAAU,CAClD,EACA,CACE,MAAO,oBACP,MAAOZ,EAAmBY,EAAQ,WAAW,EACzC,OAAOA,EAAQ,aAAgB,SAC7BA,EAAQ,YAAY,YAAY,EAChC,OAAOA,EAAQ,WAAW,EAC5B,GACJ,UAAWZ,EAAmBY,EAAQ,WAAW,CACnD,EACA,CACE,MAAO,QACP,MAAOA,EAAQ,SAAW,OAAaA,EAAQ,OAAS,MAAQ,KAAQ,GACxE,UAAWA,EAAQ,SAAW,MAChC,EACA,CACE,MAAO,aACP,MAAOV,EAAeU,EAAQ,QAAQ,EAClC,OAAOA,EAAQ,UAAa,SAC1BA,EAAQ,SAAS,YAAY,EAC7B,OAAOA,EAAQ,QAAQ,EACzB,GACJ,UAAWV,EAAeU,EAAQ,QAAQ,CAC5C,EACA,CACE,MAAO,UACP,MAAOV,EAAeU,EAAQ,eAAe,EACzC,OAAOA,EAAQ,iBAAoB,SACjCA,EAAQ,gBAAgB,YAAY,EACpC,OAAOA,EAAQ,eAAe,EAChC,GACJ,UAAWV,EAAeU,EAAQ,eAAe,CACnD,EACA,CACE,MAAO,kBACP,MAAOA,EAAQ,YACf,UAAWA,EAAQ,cAAgB,MAAA,CAEvC,EAEA,aACG,MAAI,CAAA,UAAU,iCACb,SAACwC,EAAA,KAAA,MAAA,CAAI,UAAU,oBACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,wCAEb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,WACZ,SAAA,CAAAxC,EAAQ,WAAaA,EAAQ,UAAU,OAAS,EAC/C7B,EAAA,IAAC,MAAA,CACC,UAAU,wDACT,GAAI6D,EACD,CACE,aAAcE,EACd,YAAaC,EACb,WAAYC,EACZ,cAAeC,CAAA,EAEjB,CAAC,EAEL,SAAAlE,EAAA,IAAC,MAAA,CACC,UAAU,4DACV,MAAO,CAAE,UAAW,eAAemC,EAAoB,GAAG,IAAK,EAE9D,WAAQ,UAAU,IAAKhC,SACrB,MAAc,CAAA,UAAU,iCACvB,SAAAH,EAAA,IAACN,GAAY,IAAKS,EAAK,IAAKoE,CAAW,CAAA,CAAA,EAD/BpE,CAEV,CACD,CAAA,CAAA,CACH,CAAA,EAGFH,EAAAA,IAAC,MAAI,CAAA,UAAU,uDACb,SAACA,EAAA,IAAAN,EAAA,CAAY,MAAK2D,EAAAxB,EAAQ,YAAR,YAAAwB,EAAoB,KAAM,GAAI,IAAKkB,CAAW,CAAA,EAClE,EAED1C,EAAQ,WAAaA,EAAQ,UAAU,OAAS,GAE7CwC,EAAA,KAAAI,WAAA,CAAA,SAAA,CAACzE,EAAAA,IAAAM,GAAA,CAAc,MAAOuB,EAAQ,UAAU,OAAQ,YAAaM,EAAmB,SAAUuB,CAAgB,CAAA,EACzG1D,EAAA,IAAA,MAAA,CAAI,UAAU,4BACb,SAACA,EAAAA,IAAA,MAAA,CAAI,UAAU,+BACZ,SAAQ6B,EAAA,UAAU,IAAI,CAAC1B,EAAKQ,IAC1BX,EAAAA,IAAAC,GAAA,CAA0B,IAAAE,EAAU,OAAQgC,IAAsBxB,EAAO,QAAS,IAAMyB,EAAqBzB,CAAK,CAA7F,EAAAR,CAAgG,CACvH,CACH,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,EAEJ,EAGAkE,EAAAA,KAAC,MAAI,CAAA,UAAU,mDACb,SAAA,CAACrE,EAAA,IAAA,KAAA,CAAG,UAAU,yBAA0B,SAAUuE,EAAA,EAClDF,EAAAA,KAAC,MAAI,CAAA,UAAU,yBACb,SAAA,CAACrE,EAAAA,IAAAY,EAAA,CAAY,OAAQiB,EAAQ,MAAQ,CAAA,EACrCwC,EAAAA,KAAC,OAAK,CAAA,UAAU,6BAA6B,SAAA,CAAA,IAAExC,EAAQ,cAAc,YAAA,EAAU,EAC/EwC,EAAAA,KAAC,OAAK,CAAA,UAAU,6BAA6B,SAAA,CAAA,YAAUxC,EAAQ,GAAG,MAAM,EAAG,CAAC,EAAE,YAAY,CAAA,CAAE,CAAA,CAAA,EAC9F,EACAwC,EAAAA,KAAC,MAAI,CAAA,UAAU,qDACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,0BACb,SAAA,CAAArE,EAAAA,IAAC,QAAK,SAAM,QAAA,CAAA,EACX6B,EAAQ,SAAW,SAClB7B,EAAAA,IAAC0E,GAAc,UAAU,uBAAwB,CAAA,EAC/C7C,EAAQ,SAAW,eACpB8C,EAAQ,CAAA,UAAU,yBAA0B,CAAA,EAC3C9C,EAAQ,SAAW,aACpB7B,EAAA,IAAA4E,EAAA,CAAY,UAAU,wBAAA,CAAyB,EAC9C,KACH5E,EAAA,IAAA,OAAA,CACE,SAAQ6B,EAAA,SAAW,SAChB,SACAA,EAAQ,SAAW,SACnB,QACAA,EAAQ,SAAW,aACnB,aACA,EACN,CAAA,CAAA,EACF,EACCV,EAAeU,EAAQ,IAAI,GACzBwC,EAAAA,KAAA,MAAA,CAAI,UAAU,gCACb,SAAA,CAAArE,EAAAA,IAAC,QAAK,SAAI,MAAA,CAAA,EACTA,EAAA,IAAA,OAAA,CAAM,SAAeoB,EAAAS,EAAQ,IAAI,EAAE,EACpC7B,EAAAA,IAAC6E,EAAc,CAAA,UAAU,6BAA8B,CAAA,CAAA,CACzD,CAAA,CAAA,EAEJ,EACA7E,EAAAA,IAAC,OAAI,UAAU,OACZ,WAAQ,WACPqE,EAAA,KAAC,MAAI,CAAA,UAAU,0BACb,SAAA,CAACA,EAAAA,KAAA,OAAA,CAAK,UAAU,kCAAmC,SAAA,CAAQxC,EAAA,WAAW,IAAA,EAAE,EACxEwC,EAAAA,KAAC,OAAK,CAAA,UAAU,qCAAsC,SAAA,CAAQxC,EAAA,MAAM,IAAA,CAAE,CAAA,CAAA,CACxE,CAAA,EAEAwC,EAAAA,KAAC,OAAK,CAAA,UAAU,qBAAsB,SAAA,CAAQxC,EAAA,MAAM,IAAA,CAAA,CAAE,CAE1D,CAAA,EACAwC,EAAAA,KAAC,MAAI,CAAA,UAAU,+BACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,sDACb,SAAA,CAACrE,EAAAA,IAAA,SAAA,CAAO,QAAS,IAAMuD,EAAqB,EAAE,EAAG,UAAU,4CAA4C,SAAC,GAAA,CAAA,EACxGvD,EAAA,IAAC,QAAA,CACC,KAAK,SACL,IAAI,IACJ,MAAOiC,EACP,SAAW2B,GAAM1B,EAAY,KAAK,IAAI,EAAG,OAAO0B,EAAE,OAAO,KAAK,GAAK,CAAC,CAAC,EACrE,UAAU,gDAAA,CACZ,EACA5D,EAAAA,IAAC,UAAO,QAAS,IAAMuD,EAAqB,CAAC,EAAG,UAAU,4CAA4C,SAAC,GAAA,CAAA,CAAA,EACzG,EACAvD,EAAAA,IAAC,SAAO,CAAA,QAAS,IAAMqC,EAAQR,EAAQ,GAAII,CAAQ,EAAG,UAAU,2FAA2F,SAE3J,QAAA,CAAA,CAAA,EACF,EACAoC,EAAAA,KAAC,MAAI,CAAA,UAAU,6CACb,SAAA,CAACrE,EAAA,IAAA,KAAA,CAAG,UAAU,6BAA6B,SAAQ,WAAA,EACnDA,EAAAA,IAAC,KAAE,SAAuB,yBAAA,CAAA,EAC1BA,EAAAA,IAAC,KAAE,SAA+B,iCAAA,CAAA,EAClCA,EAAAA,IAAC,KAAE,SAA+D,iEAAA,CAAA,EACjEA,EAAA,IAAA,KAAA,CAAG,UAAU,kCAAkC,SAAM,SAAA,EACtDA,EAAAA,IAAC,KAAE,SAAoC,sCAAA,CAAA,EACvCA,EAAAA,IAAC,KAAE,SAA6B,+BAAA,CAAA,EAChCA,EAAAA,IAAC,KAAE,SAA0C,4CAAA,CAAA,CAAA,EAC/C,EACAqE,EAAAA,KAAC,MAAI,CAAA,UAAU,OACb,SAAA,CAACrE,EAAA,IAAA,KAAA,CAAG,UAAU,6BAA6B,SAAwB,2BAAA,EACnEqE,EAAAA,KAAC,MAAI,CAAA,UAAU,YACZ,SAAA,CAAgBG,EAAA,IACf,CAACM,EAAMnE,IACLmE,EAAK,WACFT,OAAA,MAAA,CAAgB,UAAU,uBACzB,SAAA,CAACrE,EAAAA,IAAA,OAAA,CAAM,WAAK,KAAM,CAAA,EAClBA,EAAAA,IAAC,OAAM,CAAA,SAAA8E,EAAK,KAAM,CAAA,CAAA,CAAA,EAFVnE,CAGV,CAEN,EACCQ,EAAeU,EAAQ,OAAO,GAC5BwC,EAAAA,KAAA,MAAA,CAAI,UAAU,uBACb,SAAA,CAAArE,EAAAA,IAAC,QAAK,SAAO,SAAA,CAAA,EACbqE,EAAAA,KAAC,OAAK,CAAA,UAAU,0BACd,SAAA,CAAArE,EAAA,IAAC+E,EAAA,CACC,YAAAT,EACA,IAAG,GACH,UAAU,8BACV,MAAOzC,EAAQ,QACf,aAAYA,EAAQ,OAAA,CACtB,EACA7B,EAAAA,IAAC,OAAM,CAAA,SAAA6B,EAAQ,OAAQ,CAAA,CAAA,CACzB,CAAA,CAAA,CACF,CAAA,CAAA,CAEJ,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,EACF,EAGAwC,EAAAA,KAAC,MAAI,CAAA,UAAU,eACb,SAAA,CAACrE,EAAA,IAAA,KAAA,CAAG,UAAU,0BAA0B,SAAiB,oBAAA,EACxD6C,EACEwB,EAAAA,KAAA,OAAA,CAAK,SAAUV,EAAc,UAAU,iCACtC,SAAA,CAACU,EAAAA,KAAA,MAAA,CAAI,UAAU,OACb,SAAA,CAACrE,EAAA,IAAA,QAAA,CAAM,UAAU,yBAAyB,SAAY,eAAA,EACtDA,EAAA,IAAC,SAAA,CACC,MAAOa,EACP,SAAW+C,GAAMhB,EAAU,OAAOgB,EAAE,OAAO,KAAK,CAAC,EACjD,UAAU,4BAET,SAAC,CAAA,EAAG,EAAG,EAAG,EAAG,CAAC,EAAE,IAAKoB,GACnBX,EAAAA,KAAA,SAAA,CAAiB,MAAOW,EACtB,SAAA,CAAAA,EAAI,IAAA,CAAA,EADMA,CAEb,CACD,CAAA,CAAA,CACH,EACF,EAEAhF,EAAA,IAAC,WAAA,CACC,MAAO0C,EACP,SAAWkB,GAAMjB,EAAciB,EAAE,OAAO,KAAK,EAC7C,UAAU,iCACV,YAAY,yBACZ,KAAM,EACN,SAAQ,EAAA,CACV,QAEC,SAAO,CAAA,KAAK,SAAS,UAAU,6DAA6D,SAE7F,cAAA,CAAA,CAAA,CACF,CAAA,EAEA5D,EAAAA,IAAC,MAAI,CAAA,UAAU,2BACb,SAAAA,EAAA,IAAC,SAAA,CACC,QAAS,IAAMyB,EAAS,QAAS,CAAE,MAAO,CAAE,KAAME,EAAS,QAAS,EAAG,EACvE,UAAU,+EACX,SAAA,iBAAA,CAAA,EAGH,EAGD3B,EAAA,IAAA,MAAA,CAAI,UAAU,YACZ,WAAQ,MAAM,EAAG,CAAC,EAAE,IAAKiF,GACvBZ,EAAA,KAAA,MAAA,CAAoB,UAAU,2CAC7B,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,yCACb,SAAA,CAAArE,EAAA,IAACY,EAAY,CAAA,OAAQqE,EAAO,OAAQ,cAAc,UAAU,EAC5DjF,EAAAA,IAAC,OAAK,CAAA,UAAU,wBAAyB,SAAA,IAAI,KAAKiF,EAAO,UAAU,EAAE,mBAAmB,OAAO,CAAE,CAAA,CAAA,EACnG,EACCjF,EAAA,IAAA,IAAA,CAAE,UAAU,qBAAsB,WAAO,QAAQ,EAClDqE,EAAAA,KAAC,MAAI,CAAA,UAAU,wBAAwB,SAAA,CAAA,yBACdY,EAAO,QAAQ,MAAM,EAAG,CAAC,CAAA,CAClD,CAAA,CARQ,CAAA,EAAAA,EAAO,EASjB,CACD,EACH,EACCpD,EAAQ,cAAgB,GACtB7B,EAAA,IAAA,MAAA,CAAI,UAAU,2BACb,SAAAqE,EAAA,KAACa,EAAA,CACC,GAAI,YAAY3D,CAAE,WAClB,UAAU,+EACX,SAAA,CAAA,8BAC6BM,EAAQ,cAAc,GAAA,CAAA,CAAA,CAEtD,CAAA,CAAA,CAEJ,CAAA,CAAA,CAAA,CACF,CACF,CAAA,CAEJ,EAEe3B,GAAAA,EAAAA,KAAKoB,EAAa"}